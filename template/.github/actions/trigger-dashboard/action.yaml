name: Trigger dashboard build
description: Dispatch dashboard workflow as easyscience[bot]
inputs:
  ref:
    required: true
  app-id:
    required: true
  private-key:
    required: true
  workflow-id:
    required: false
    default: dashboard.yaml

runs:
  using: composite
  steps:
    - name: Setup easyscience[bot]
      id: bot
      uses: ./.github/actions/setup-easyscience-bot
      with:
        app-id: ${{ inputs.app-id }}
        private-key: ${{ inputs.private-key }}

    - name: Trigger dashboard build
      uses: ./.github/actions/github-script
      with:
        github-token: ${{ steps.bot.outputs.token }}
        script: |
          await github.rest.actions.createWorkflowDispatch({
            owner: context.repo.owner,
            repo: context.repo.repo,
            workflow_id: "${{ inputs.workflow-id }}",
            ref: "${{ inputs.ref }}"
          });